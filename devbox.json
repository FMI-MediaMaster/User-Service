{
  "packages": [
    "eslint_d@14.3.0",
    "bruno@2.12.0",
    "docker@28.4.0",
    "nodejs@24.10.0",
    "fixjson@1.1.2-unstable-2021-01-05"
  ],
  "env": {
    "DEVBOX_COREPACK_ENABLED": "true",
    "TEMPLATE_NAME": "servertemplate"
  },
  "shell": {
    "init_hook": [
      "if ! diff -q <(fixjson devbox.json) devbox.json >/dev/null 2>&1; then fixjson -w devbox.json; fi",
      "pnpm install",
      "git remote get-url $TEMPLATE_NAME >/dev/null 2>&1 || git remote add -f $TEMPLATE_NAME https://github.com/FMI-MediaMaster/ServerTemplate.git",
      "export SERVICE_NAME=$(basename -s .git \"$(git config --get remote.origin.url)\" | tr '[:upper:]' '[:lower:]')"
    ],
    "scripts": {
      "bruno": "nohup bruno >/dev/null 2>&1 &",
      "template:fetch": "git fetch $TEMPLATE_NAME",
      "docker:build": "docker build -t $SERVICE_NAME .",
      "docker:pull": "docker pull ghcr.io/fmi-mediamaster/$SERVICE_NAME:latest",
      "docker:run:local": "ENV_FILE=\"$(pwd)/.env\" && source \"$ENV_FILE\" && docker run -d --rm -v \"$ENV_FILE:/app/.env\" -p $PORT:$PORT --name $SERVICE_NAME $SERVICE_NAME",
      "docker:run": "ENV_FILE=\"$(pwd)/.env\" && source \"$ENV_FILE\" && docker run -d --rm -v \"$ENV_FILE:/app/.env\" -p $PORT:$PORT --name $SERVICE_NAME ghcr.io/fmi-mediamaster/$SERVICE_NAME:latest",
      "docker:stop": "docker stop $SERVICE_NAME"
    }
  }
}
